{% extends "base.html" %}
{% block content %}
<div class="page-header">
	<h1>Добавление объектов</h1>
</div>
<!-- <ul class="pagination">
  <li><a href="0">1</a></li>
  <li class="active"><a href="1">2</a></li>
  <li><a href="2">3</a></li>
  <li><a href="3">4</a></li>
</ul> -->

<form action="/add_system" method="POST" class="form-horizontal">
	{% csrf_token %}
	<div class="row">
		<div class="col-md-5 js-attributes__column">
			<div class="row js-attributes attributes">
				<h2 class="attributes__title">Атрибуты:</h2>
				<div class="js-attributes__item attributes__item">
					<div class="form-group">
						<label for="inputEmail3" class="col-md-3 control-label">Название атрибута</label>
						<div class="col-md-9">
							<input type="text" class="form-control" id="inputEmail3" placeholder="Нос">
						</div>
					</div>
					<div class="form-group attributes__item__value">
						<label for="inputEmail3" class="col-md-3 control-label">Значение</label>
						<div class="col-md-7">
							<input type="text" class="form-control" id="inputEmail3" placeholder="Чистый">
						</div>
						<div class="col-md-2">
							<button type="button" class="js-attributes__item__add-value btn btn-warning">
						<i class="glyphicon-plus glyphicon"></i></button>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2 col-md-offset-10">
					<button type="button" class="js-attributes__add-item attributes__add-item btn btn-warning btn-lg"><i class="glyphicon-plus glyphicon"></i></button></button>
				</div>
			</div>
		</div>
		<div class="col-md-6 col-md-offset-1">
			<div class="row js-objects">
				<h2 class="attributes__title">Объекты:</h2>
				<div class="js-objects__item attributes__item">
					<h3 class="attributes__item__title">Название: <input type="text" class="form-control attributes__item__title-input" placeholder="Крыса"></h3>
					<div class="form-group">
						<label for="inputEmail3" class="col-md-2 control-label">Нос</label>
						<div class="col-md-10">
							<input type="text" class="form-control" id="inputEmail3" placeholder="Чистый">
						</div>
					</div>
					<!-- <div class="form-group">
						<label for="inputEmail3" class="col-md-2 control-label">Крыса</label>
						<div class="col-md-10">
							<input type="text" class="form-control" id="inputEmail3" placeholder="Чистая">
						</div>
					</div> -->
				</div>
			</div>
			<div class="row">
				<div class="col-md-2 col-md-offset-10 attributes__add-item__wrapper">
					<button type="button" class="js-objects__add-item attributes__add-item btn btn-warning btn-lg"><i class="glyphicon-plus glyphicon"></i></button></button>
				</div>
			</div>
		</div>
	</div>
</form>
<script>
	$('.js-attributes__item__add-value').on('click', addAttributeValue);
	var self = this
	function addAttributeValue (evt) {
		var $target = $(evt.target),
			$block = $target.closest('.attributes__item__value'),
			$blockClone = $block.clone();

		$blockClone.find('.js-attributes__item__add-value').on('click', addAttribute);
		$block.closest('.attributes__item').append($blockClone);
		// $block.find('.js-attributes__item__add-value').off('click', addAttribute);
		$target.closest('button').remove();
	}

	$('.js-attributes__add-item').on('click', addAttribute);
	function addAttribute (evt) {
		var $target = $(evt.target),
			$block = $('.js-attributes__item').eq(0),
			$blockClone = $block.clone();

		// $blockClone.find('.js-attributes__add-item').on('click', addAttribute);
		$blockClone.find('.js-attributes__item__add-value').on('click', addAttributeValue);
		$block.closest('.js-attributes').append($blockClone);
		// $block.find('.js-attributes__item__add-value').off('click', addAttribute);
		// $target.closest('button').remove();
	}

	$('.js-objects__add-item').on('click', addObject);
	function addObject (evt) {
		var $target = $(evt.target),
			$block = $('.js-objects__item').eq(0),
			$blockClone = $block.clone();

		// $blockClone.find('.js-attributes__add-item').on('click', addAttribute);
		$block.closest('.js-objects').append($blockClone);
		// $block.find('.js-attributes__item__add-value').off('click', addAttribute);
		// $target.closest('button').remove();
	}
</script>
{% endblock %}
